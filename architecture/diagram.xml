<mxfile host="app.diagrams.net">
  <diagram id="RescueMindArch" name="RescueMind Architecture">
    <mxGraphModel>
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Frontend cluster -->
        <mxCell id="frontend" value="Frontend" style="swimlane" vertex="1" parent="1">
          <mxGeometry x="20" y="40" width="220" height="200" as="geometry"/>
        </mxCell>
        <mxCell id="web" value="Web (S3+CloudFront)" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="frontend">
          <mxGeometry x="20" y="40" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="client" value="Web Client (React/MapLibre)" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="frontend">
          <mxGeometry x="20" y="100" width="180" height="40" as="geometry"/>
        </mxCell>

        <!-- AgentCore cluster -->
        <mxCell id="agent" value="AgentCore" style="swimlane" vertex="1" parent="1">
          <mxGeometry x="280" y="40" width="260" height="320" as="geometry"/>
        </mxCell>
        <mxCell id="bedrock" value="Bedrock LLM" style="ellipse;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="40" y="40" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="kb" value="Knowledge Base / Amazon Q" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="40" y="120" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ag1" value="fetch_weather_alerts" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="20" y="180" width="220" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="ag2" value="geocode_and_cluster" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="20" y="215" width="220" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="ag3" value="compute_routes" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="20" y="250" width="220" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="ag4" value="persist_incident" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="20" y="285" width="220" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="ag5" value="notify_responders" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="agent">
          <mxGeometry x="20" y="320" width="220" height="30" as="geometry"/>
        </mxCell>

        <!-- Data Plane cluster -->
        <mxCell id="data" value="Data Plane" style="swimlane" vertex="1" parent="1">
          <mxGeometry x="580" y="40" width="220" height="260" as="geometry"/>
        </mxCell>
        <mxCell id="ddb1" value="DynamoDB: Incidents" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="data">
          <mxGeometry x="20" y="40" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="ddb2" value="DynamoDB: Resources" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="data">
          <mxGeometry x="20" y="100" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="s3replay" value="S3 Replay" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="data">
          <mxGeometry x="20" y="160" width="180" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="eventbridge" value="EventBridge" style="ellipse;whiteSpace=wrap;" vertex="1" parent="data">
          <mxGeometry x="20" y="210" width="180" height="40" as="geometry"/>
        </mxCell>

        <!-- API Gateway node -->
        <mxCell id="apigw" value="API Gateway (WebSocket)" style="shape=rectangle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="280" y="380" width="260" height="40" as="geometry"/>
        </mxCell>

        <!-- Flows -->
        <mxCell id="flow1" edge="1" parent="1" source="eventbridge" target="bedrock">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow2" edge="1" parent="1" source="bedrock" target="ag1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow3" edge="1" parent="1" source="kb" target="bedrock">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow4" edge="1" parent="1" source="ag1" target="s3replay">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow5" edge="1" parent="1" source="ag2" target="ddb1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow6" edge="1" parent="1" source="ag3" target="ddb1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow7" edge="1" parent="1" source="ag4" target="ddb1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow8" edge="1" parent="1" source="ag5" target="apigw">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="flow9" edge="1" parent="1" source="apigw" target="client">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>